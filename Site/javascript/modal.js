// CSS Modal
// http://drublic.github.com/css-modal
// @author Hans Christian Reinl - @drublic
// @version 1.0.4
(function(e){"use strict";var t={};t.lastActive=undefined;t.activeElement=undefined;t._addEventListener=function(e,t,n){if(e.addEventListener){e.addEventListener(t,n,false)}else{e.attachEvent("on"+t,n)}};t._addEventListener(document,"keyup",function(e){var n=window.location.hash.replace("#","");if(n===""||n==="!"){return}if(e.keyCode===27){window.location.hash="!";if(t.lastActive){return false}t.removeFocus()}},false);t._dispatchEvent=function(e,t){var n;if(!document.createEvent){return}n=document.createEvent("Event");n.initEvent(e,true,true);n.customData={modal:t};document.dispatchEvent(n)};t.mainHandler=function(){var e=window.location.hash.replace("#","");var n=document.getElementById(e);var r=document.documentElement.className;var i;var s;if(n){i=n.children[0];if(i&&i.className.match(/modal-inner/)){if(!r.match(/has-overlay/)){document.documentElement.className+=" has-overlay"}if(t.activeElement){s=t.activeElement;s.className=s.className.replace(" is-active","")}n.className+=" is-active";t.activeElement=n;t.setFocus(e);t._dispatchEvent("cssmodal:show",t.activeElement)}}else{document.documentElement.className=r.replace(" has-overlay","");if(t.activeElement){t.activeElement.className=t.activeElement.className.replace(" is-active","");t._dispatchEvent("cssmodal:hide",t.activeElement);t.activeElement=null;t.removeFocus()}}};t._addEventListener(window,"hashchange",t.mainHandler);t._addEventListener(window,"load",t.mainHandler);t.setFocus=function(){if(t.activeElement){t.lastActive=document.activeElement;t.activeElement.focus()}};t.removeFocus=function(){if(t.lastActive){t.lastActive.focus()}};e.CSSModal=t})(window)